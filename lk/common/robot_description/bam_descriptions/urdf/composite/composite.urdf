<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="composite">

<!--
Auto-generated Composite URDF
Generated for: 2 descriptions, 3 custom joints, 2 custom links

Note: This URDF was generated by expanding each description macro separately
to avoid namespace conflicts, then combining the expanded XML.
-->
  <!-- Start of macro 0: UR (type=ur) -->

  <!-- start macro xml -->
<!-- links -  main serial chain -->
  <!-- base_link_ur serves as the root of the robot's kinematic tree. It follows REP-103
        conventions (i.e., X+ forward, Y+ left, Z+ up).
        Since some kinematic solvers forbid having inertia values attached to a root link, we've
        added the base_link_inertia link that carries the visual, collision and inertia
        information.
    -->
  <!-- Rename base_link to base_link_ur so you can add another base_link_ur outside... -->
  <link name="ur_base_link_ur"/>
  <link name="ur_base_link_inertia">
    <visual>
      <origin rpy="0.0 0.0 3.141592653589793" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/base.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0.0 0.0 3.141592653589793" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/base.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="4.0"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.00443333156" ixy="0.0" ixz="0.0" iyy="0.00443333156" iyz="0.0" izz="0.0072"/>
    </inertial>
  </link>
  <link name="ur_shoulder_link">
    <visual>
      <origin rpy="0.0 0.0 3.141592653589793" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/shoulder.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0.0 0.0 3.141592653589793" xyz="0.0 0.0 0.0"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/shoulder.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="3.761"/>
      <origin rpy="1.570796326794897 0 0" xyz="0.0 -0.00193 -0.02561"/>
      <inertia ixx="0.0070021" ixy="7.3e-07" ixz="-1.053e-05" iyy="0.00648091" iyz="0.00049994" izz="0.00657286"/>
    </inertial>
  </link>
  <link name="ur_upper_arm_link">
    <visual>
      <origin rpy="1.5707963267948966 0.0 -1.5707963267948966" xyz="0.0 0.0 0.138"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/upperarm.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0.0 -1.5707963267948966" xyz="0.0 0.0 0.138"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/upperarm.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="8.058"/>
      <origin rpy="0 0 0" xyz="-0.2125 0.0 0.11336"/>
      <inertia ixx="0.01505885" ixy="-5.4e-05" ixz="5.63e-06" iyy="0.33388086" iyz="-1.81e-06" izz="0.33247207"/>
    </inertial>
  </link>
  <link name="ur_forearm_link">
    <visual>
      <origin rpy="1.5707963267948966 0.0 -1.5707963267948966" xyz="0.0 0.0 0.007"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/forearm.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0.0 -1.5707963267948966" xyz="0.0 0.0 0.007"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/forearm.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="2.846"/>
      <origin rpy="0 0 0" xyz="-0.2422 0.0 0.0265"/>
      <inertia ixx="0.00399632" ixy="-1.365e-05" ixz="0.00137272" iyy="0.07879254" iyz="-6.6e-06" izz="0.0784851"/>
    </inertial>
  </link>
  <link name="ur_wrist_1_link">
    <visual>
      <origin rpy="1.5707963267948966 0.0 0.0" xyz="0.0 0.0 -0.127"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/wrist1.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0.0 0.0" xyz="0.0 0.0 -0.127"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/wrist1.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.37"/>
      <origin rpy="1.570796326794897 0 0" xyz="0.0 -0.01634 -0.0018"/>
      <inertia ixx="0.00165491" ixy="-2.82e-06" ixz="-4.38e-06" iyy="0.00135962" iyz="0.00010157" izz="0.00126279"/>
    </inertial>
  </link>
  <link name="ur_wrist_2_link">
    <visual>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.0997"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/wrist2.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.0997"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/wrist2.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.3"/>
      <origin rpy="-1.570796326794897 0 0" xyz="0.0 0.01634 -0.0018"/>
      <inertia ixx="0.00135617" ixy="-2.74e-06" ixz="4.44e-06" iyy="0.00127827" iyz="-5.048e-05" izz="0.00096614"/>
    </inertial>
  </link>
  <link name="ur_wrist_3_link">
    <visual>
      <origin rpy="1.5707963267948966 0.0 0.0" xyz="0.0 0.0 -0.0989"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/visual/wrist3.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0.0 0.0" xyz="0.0 0.0 -0.0989"/>
      <geometry>
        <mesh filename="package://ur_description/meshes/ur5e/collision/wrist3.stl"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.365"/>
      <origin rpy="0 0 0" xyz="0.0 0.0 -0.001159"/>
      <inertia ixx="0.00018694" ixy="6e-08" ixz="-1.7e-07" iyy="0.00018908" iyz="-9.2e-07" izz="0.00025756"/>
    </inertial>
  </link>
  <!-- base_joint fixes base_link_ur to the environment -->
  <!-- <joint name="${tf_prefix}base_joint" type="fixed">
      <xacro:insert_block name="origin" />
      <parent link="${parent}" />
      <child link="${tf_prefix}base_link_ur" />
    </joint> -->
  <!-- joints - main serial chain -->
  <joint name="ur_base_link_ur-base_link_inertia" type="fixed">
    <parent link="ur_base_link_ur"/>
    <child link="ur_base_link_inertia"/>
    <!-- 'base_link_ur' is REP-103 aligned (so X+ forward), while the internal
           frames of the robot/controller have X+ pointing backwards.
           Use the joint between 'base_link_ur' and 'base_link_inertia' (a dummy
           link/frame) to introduce the necessary rotation over Z (of pi rad).
      -->
    <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
  </joint>
  <joint name="ur_shoulder_pan_joint" type="revolute">
    <parent link="ur_base_link_inertia"/>
    <child link="ur_shoulder_link"/>
    <origin rpy="0 0 0" xyz="0 0 0.1625"/>
    <axis xyz="0 0 1"/>
    <limit effort="150.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
    <!-- Increase friction in lower joints, they seem to be osscilating alot in sim, and we know friction increases with load -->
    <dynamics damping="0.05" friction="0.3"/>
  </joint>
  <joint name="ur_shoulder_lift_joint" type="revolute">
    <parent link="ur_shoulder_link"/>
    <child link="ur_upper_arm_link"/>
    <origin rpy="1.570796327 0 0" xyz="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit effort="150.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
    <dynamics damping="0.05" friction="0.3"/>
  </joint>
  <joint name="ur_elbow_joint" type="revolute">
    <parent link="ur_upper_arm_link"/>
    <child link="ur_forearm_link"/>
    <origin rpy="0 0 0" xyz="-0.425 0 0"/>
    <axis xyz="0 0 1"/>
    <limit effort="150.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
    <dynamics damping="0.05" friction="0.1"/>
  </joint>
  <joint name="ur_wrist_1_joint" type="revolute">
    <parent link="ur_forearm_link"/>
    <child link="ur_wrist_1_link"/>
    <origin rpy="0 0 0" xyz="-0.3922 0 0.1333"/>
    <axis xyz="0 0 1"/>
    <limit effort="28.0" lower="-4.71238898038469" upper="1.5707963267948966" velocity="3.141592653589793"/>
    <dynamics damping="0.05" friction="0.1"/>
  </joint>
  <joint name="ur_wrist_2_joint" type="revolute">
    <parent link="ur_wrist_1_link"/>
    <child link="ur_wrist_2_link"/>
    <origin rpy="1.570796327 0 0" xyz="0 -0.0997 -2.044881182297852e-11"/>
    <axis xyz="0 0 1"/>
    <limit effort="28.0" lower="-4.71238898038469" upper="1.5707963267948966" velocity="3.141592653589793"/>
    <dynamics damping="0.05" friction="0.1"/>
  </joint>
  <joint name="ur_wrist_3_joint" type="revolute">
    <parent link="ur_wrist_2_link"/>
    <child link="ur_wrist_3_link"/>
    <origin rpy="1.570796326589793 3.141592653589793 3.141592653589793" xyz="0 0.0996 -2.042830148012698e-11"/>
    <axis xyz="0 0 1"/>
    <limit effort="28.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="3.141592653589793"/>
    <dynamics damping="0.05" friction="0.1"/>
  </joint>
  <!-- The FT Frame has the same pose as tool0_flip, but we add tool0_flip because its more verbose -->
  <link name="ur_ft_frame"/>
  <joint name="ur_wrist_3_link-ft_frame" type="fixed">
    <parent link="ur_wrist_3_link"/>
    <child link="ur_ft_frame"/>
    <origin rpy="3.141592653589793 0 0" xyz="0 0 0"/>
  </joint>
  <!-- ROS-Industrial 'base' frame - base_link_ur to UR 'Base' Coordinates transform -->
  <link name="ur_base"/>
  <joint name="ur_base_link_ur-base_fixed_joint" type="fixed">
    <!-- Note the rotation over Z of pi radians - as base_link_ur is REP-103
           aligned (i.e., has X+ forward, Y+ left and Z+ up), this is needed
           to correctly align 'base' with the 'Base' coordinate system of
           the UR controller.
      -->
    <origin rpy="0 0 3.141592653589793" xyz="0 0 0"/>
    <parent link="ur_base_link_ur"/>
    <child link="ur_base"/>
  </joint>
  <!-- ROS-Industrial 'flange' frame - attachment point for EEF models -->
  <link name="ur_flange"/>
  <joint name="ur_wrist_3-flange" type="fixed">
    <parent link="ur_wrist_3_link"/>
    <child link="ur_flange"/>
    <origin rpy="0 -1.5707963267948966 -1.5707963267948966" xyz="0 0 0"/>
  </joint>
  <!-- ROS-Industrial 'tool0' frame - all-zeros tool frame -->
  <link name="ur_tool0"/>
  <joint name="ur_flange-tool0" type="fixed">
    <!-- default toolframe - X+ left, Y+ up, Z+ front -->
    <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0 0 0"/>
    <parent link="ur_flange"/>
    <child link="ur_tool0"/>
  </joint>
  <!-- https://github.com/ros-industrial/universal_robot/pull/506/files -->
  <!-- Link from original ur_kinematics, see notes in the ur_ros1 package-->
  <link name="ur_ee_link"/>
  <joint name="ur_ee_fixed_joint" type="fixed">
    <parent link="ur_wrist_3_link"/>
    <child link="ur_ee_link"/>
    <origin rpy="0.0 -1.5707963267948966 1.5707963267948966" xyz="0 0 0"/>
  </joint>
  <!-- For testing IK offset converions, helpful to have a offset tcp link -->
  <link name="ur_tcp_world_test"/>
  <joint name="ur_tool0_to_tcp_world_test" type="fixed">
    <parent link="ur_tool0"/>
    <child link="ur_tcp_world_test"/>
    <!-- Go forward a bit along z and flip around -->
    <origin rpy="3.141592653589793 0 0" xyz="0 0 0.1"/>
  </joint>
  <link name="ur_tool0_flip"/>
  <joint name="ur_tool0-tool0flip" type="fixed">
    <origin rpy="3.141592653589793 0 0" xyz="0 0 0"/>
    <parent link="ur_tool0"/>
    <child link="ur_tool0_flip"/>
  </joint>
  <!-- end macro xml -->
  <!-- End of macro 0 -->

  <!-- Start of macro 1: ConveyorDescription (type=conveyor) -->

  <!-- start macro xml -->
<!--
    Conveyor belt macro with rollers and railings.
    
    Visual design:
    - Main belt (box)
    - Two railings on either side
    - Roller cylinders at front and back edges
    
    Frame structure:
    - surface_center: Center of top surface (PRIMARY REFERENCE)
    - center: Geometric center of conveyor box
    - surface_front: Front edge of top surface
    - roller_front: Front roller position
    - roller_back: Back roller position
  -->
  <!-- Surface center link (PRIMARY REFERENCE FRAME) -->
  <link name="surface_center"/>
  <!-- Center link (geometric center of box) -->
  <joint name="surface_center_to_center" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 -0.025"/>
    <parent link="surface_center"/>
    <child link="center"/>
  </joint>
  <link name="center">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.4 1.45 0.05"/>
      </geometry>
      <material name="ConveyorGrey">
        <color rgba="0.2 0.2 0.2 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.4 1.45 0.05"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0"/>
      <mass value="10.0"/>
      <inertia ixx="1.7541666666666664" ixy="0" ixz="0" iyy="0.13541666666666669" iyz="0" izz="1.8854166666666667"/>
    </inertial>
  </link>
  <!-- Surface front link -->
  <joint name="surface_center_to_surface_front" type="fixed">
    <origin rpy="0 0 0" xyz="0 0.75 0"/>
    <parent link="surface_center"/>
    <child link="surface_front"/>
  </joint>
  <link name="surface_front">
    <!-- Super small interia to not effect dynamics and small rviz interia box -->
    <inertial>
      <mass value="0.0001"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0.00001" ixz="0.00001" iyy="0.001" iyz="0.00001" izz="0.001"/>
    </inertial>
  </link>
  <!-- Front roller (positioned so outer edge aligns with conveyor length) -->
  <joint name="surface_center_to_roller_front" type="fixed">
    <origin rpy="0 0 0" xyz="0 0.725 -0.025"/>
    <parent link="surface_center"/>
    <child link="roller_front"/>
  </joint>
  <link name="roller_front">
    <visual>
      <origin rpy="0 1.5707963267948966 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.4" radius="0.025"/>
      </geometry>
      <material name="ConveyorGrey">
        <color rgba="0.2 0.2 0.2 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 1.5707963267948966 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.4" radius="0.025"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.013489583333333334" ixy="0" ixz="0" iyy="0.013489583333333334" iyz="0" izz="0.00031250000000000006"/>
    </inertial>
  </link>
  <!-- Back roller (positioned so outer edge aligns with conveyor length) -->
  <joint name="surface_center_to_roller_back" type="fixed">
    <origin rpy="0 0 0" xyz="0 -0.725 -0.025"/>
    <parent link="surface_center"/>
    <child link="roller_back"/>
  </joint>
  <link name="roller_back">
    <visual>
      <origin rpy="0 1.5707963267948966 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.4" radius="0.025"/>
      </geometry>
      <material name="ConveyorGrey">
        <color rgba="0.2 0.2 0.2 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 1.5707963267948966 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.4" radius="0.025"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0"/>
      <mass value="1.0"/>
      <inertia ixx="0.013489583333333334" ixy="0" ixz="0" iyy="0.013489583333333334" iyz="0" izz="0.00031250000000000006"/>
    </inertial>
  </link>
  <!-- Left railing -->
  <joint name="left_railing_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.21000000000000002 0 0.0"/>
    <parent link="surface_center"/>
    <child link="left_railing"/>
  </joint>
  <link name="left_railing">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 1.5 0.1"/>
      </geometry>
      <material name="RailingGrey">
        <color rgba="0.4 0.4 0.4 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 1.5 0.1"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.09416666666666665" ixy="0" ixz="0" iyy="0.00043333333333333337" iyz="0" izz="0.09376666666666666"/>
    </inertial>
  </link>
  <!-- Right railing -->
  <joint name="right_railing_joint" type="fixed">
    <origin rpy="0 0 0" xyz="-0.21000000000000002 0 0.0"/>
    <parent link="surface_center"/>
    <child link="right_railing"/>
  </joint>
  <link name="right_railing">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 1.5 0.1"/>
      </geometry>
      <material name="RailingGrey">
        <color rgba="0.4 0.4 0.4 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 1.5 0.1"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.09416666666666665" ixy="0" ixz="0" iyy="0.00043333333333333337" iyz="0" izz="0.09376666666666666"/>
    </inertial>
  </link>
  <!-- Belt joint (fixed, motor position tracked via CAN ID, not part of kinematics) -->
  <joint name="belt_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="roller_front"/>
    <child link="belt_link"/>
  </joint>
  <link name="belt_link">
    <!-- Super small interia to not effect dynamics and small rviz interia box -->
    <inertial>
      <mass value="0.0001"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0.00001" ixz="0.00001" iyy="0.001" iyz="0.00001" izz="0.001"/>
    </inertial>
  </link>
  <!-- end macro xml -->
  <!-- End of macro 1 -->

  <!-- Custom links (added directly to URDF) -->
    <link name="world"/> 

    <link name="base_link"/> 


  <!-- Custom joints (added directly to URDF) -->
    <joint name="world_to_base_link" type="fixed">
    <origin xyz="0.000000 0.000000 0.000000" rpy="0.000000 -0.000000 0.000000"/>
    <parent link="world"/>
    <child link="base_link"/>
  </joint>

    <joint name="base_link_to_conveyor" type="fixed">
    <origin xyz="0.000000 0.000000 0.000000" rpy="0.000000 -0.000000 0.000000"/>
    <parent link="base_link"/>
    <child link="surface_center"/>
  </joint>

    <joint name="conveyor_to_ur" type="fixed">
    <origin xyz="0.000000 0.000000 0.500000" rpy="0.000000 -0.000000 0.000000"/>
    <parent link="surface_center"/>
    <child link="ur_base_link_ur"/>
  </joint>


</robot>
